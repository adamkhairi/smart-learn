# Nginx vhost snippet for webdevops/php-nginx base image
# This file is included into the default server via vhost.common.d

# Try pretty URLs first, then index.php
location / {
    try_files $uri $uri/ /index.php?$query_string;
}

# Static assets: cache aggressively
location ~* \.(?:css|js|map|jpg|jpeg|png|gif|ico|svg|webp|woff|woff2|ttf)$ {
    access_log off;
    add_header Cache-Control "public, max-age=604800, immutable";
    try_files $uri =404;
}

# PHP is already wired by base image to php-fpm, ensure fastcgi params
location ~ \.php$ {
    try_files $uri =404;
    include fastcgi_params;
    # fastcgi_pass is set by the base image; we only need SCRIPT_FILENAME
    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
}
